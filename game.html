<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>3D Bloxd Master v1.0</title>
    <style>
        body { margin: 0; background: #000; color: #0f0; font-family: 'Courier New', Courier, monospace; overflow: hidden; }
        #ui { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.8); padding: 15px; border-radius: 10px; border: 2px solid #0f0; pointer-events: none; z-index: 10; }
        #crosshair { position: absolute; top: 50%; left: 50%; width: 12px; height: 12px; border: 2px solid #0f0; border-radius: 50%; transform: translate(-50%, -50%); pointer-events: none; z-index: 5; }
        #win-msg { display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: gold; font-size: 3em; font-weight: bold; text-shadow: 0 0 20px #fff; z-index: 20; background: rgba(0,0,0,0.9); padding: 20px; border-radius: 20px; border: 5px solid gold; }
        canvas { display: block; }
    </style>
</head>
<body>

    <div id="ui">
        <b>üìê 3D RAYCAST ENGINE</b><br><br>
        MOVE: <span style="color:white">W, S</span><br>
        TURN: <span style="color:white">A, D</span><br>
        GOAL: Find the <span style="color:gold">GOLD</span> wall!
    </div>

    <div id="crosshair"></div>
    <div id="win-msg">üèÜ YOU FOUND THE GOLD!</div>

    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const winMsg = document.getElementById("win-msg");
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // 1. MAP DATA (0 = Floor, 1 = Green Wall, 2 = Gold Goal)
        const map = [
            [1,1,1,1,1,1,1,1],
            [1,0,0,0,0,0,0,1],
            [1,0,1,1,1,1,0,1],
            [1,0,1,0,0,0,0,1],
            [1,0,1,0,1,1,0,1],
            [1,0,0,0,1,2,0,1],
            [1,1,0,0,1,0,0,1],
            [1,1,1,1,1,1,1,1]
        ];
        const tileSize = 64;

        let player = { x: 96, y: 96, angle: 0 };
        let keys = {};

        window.addEventListener("keydown", (e) => keys[e.key.toLowerCase()] = true);
        window.addEventListener("keyup", (e) => keys[e.key.toLowerCase()] = false);

        function draw() {
            // Draw Ceiling and Floor
            ctx.fillStyle = "#111"; ctx.fillRect(0, 0, canvas.width, canvas.height/2);
            ctx.fillStyle = "#222"; ctx.fillRect(0, canvas.height/2, canvas.width, canvas.height/2);

            const fov = Math.PI / 3;
            const rays = canvas.width / 4; // Resolution

            for (let i = 0; i < rays; i++) {
                let rayAngle = (player.angle - fov/2) + (i / rays) * fov;
                let dist = 0;
                let hit = 0; // 1 for wall, 2 for gold
                
                while (hit === 0 && dist < 1000) {
                    dist += 1;
                    let tx = Math.floor((player.x + Math.cos(rayAngle) * dist) / tileSize);
                    let ty = Math.floor((player.y + Math.sin(rayAngle) * dist) / tileSize);

                    if (ty < 0 || ty >= map.length || tx < 0 || tx >= map[0].length) {
                        hit = 1;
                    } else if (map[ty][tx] > 0) {
                        hit = map[ty][tx];
                    }
                }

                let fixDist = dist * Math.cos(rayAngle - player.angle);
                let h = (tileSize * canvas.height) / fixDist;
                
                // Color logic
                let shade = 255 - (fixDist / 4);
                if (hit === 2) {
                    ctx.fillStyle = `rgb(${shade}, ${shade*0.8}, 0)`; // Gold
                } else {
                    ctx.fillStyle = `rgb(0, ${shade}, ${shade/2})`; // Green
                }
                
                ctx.fillRect(i * 4, (canvas.height - h) / 2, 4, h);
            }
        }

        function update() {
            let nextX = player.x;
            let nextY = player.y;

            if (keys['w']) { 
                nextX += Math.cos(player.angle) * 3; 
                nextY += Math.sin(player.angle) * 3; 
            }
            if (keys['s']) { 
                nextX -= Math.cos(player.angle) * 3; 
                nextY -= Math.sin(player.angle) * 3; 
            }
            if (keys['a']) player.angle -= 0.05;
            if (keys['d']) player.angle += 0.05;

            // Collision Detection
            let tx = Math.floor(nextX / tileSize);
            let ty = Math.floor(nextY / tileSize);
            
            if (map[ty][tx] === 0) {
                player.x = nextX;
                player.y = nextY;
                winMsg.style.display = "none";
            } else if (map[ty][tx] === 2) {
                winMsg.style.display = "block"; // You win!
            }

            draw();
            requestAnimationFrame(update);
        }

        window.onresize = () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        };

        update();
    </script>
</body>
</html>
